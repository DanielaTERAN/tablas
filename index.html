<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Leer tablas de Supabase</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { margin: 5px 0; padding: 8px; width: 100%; max-width: 400px; }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background-color: #eee;
    }
    #result p.error {
      color: red;
    }
  </style>
</head>
<body>

  <h1>Leer tablas de Supabase</h1>
  
  <label for="supabaseUrl">Supabase URL:</label><br/>
  <input type="text" id="supabaseUrl" placeholder="https://tu-proyecto.supabase.co" />
  
  <label for="supabaseKey">Supabase API Key (anon/public):</label><br/>
  <input type="text" id="supabaseKey" placeholder="Tu API Key" />
  
  <label for="tableName">Nombre de la tabla:</label><br/>
  <input type="text" id="tableName" placeholder="Nombre de la tabla" />
  
  <button onclick="fetchTable()">Cargar tabla</button>
  
  <div id="result"></div>
  
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    async function fetchTable() {
      const SUPABASE_URL = document.getElementById('supabaseUrl').value.trim()
      const SUPABASE_ANON_KEY = document.getElementById('supabaseKey').value.trim()
      const table = document.getElementById('tableName').value.trim()
      const resultDiv = document.getElementById('result')
      
      if (!SUPABASE_URL || !SUPABASE_ANON_KEY || !table) {
        resultDiv.innerHTML = '<p class="error">Por favor, completa todos los campos.</p>'
        return
      }
      
      resultDiv.innerHTML = '<p>Cargando...</p>'
      
      try {
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
        
        let { data, error } = await supabase
          .from(table)
          .select('*')
          .limit(50)
          
        if (error) throw error
        
        if (!data || data.length === 0) {
          resultDiv.innerHTML = '<p>No se encontraron datos en la tabla.</p>'
          return
        }
        
        // Construir tabla HTML
        let columns = Object.keys(data[0])
        let html = '<table><thead><tr>'
        columns.forEach(col => html += `<th>${col}</th>`)
        html += '</tr></thead><tbody>'
        
        data.forEach(row => {
          html += '<tr>'
          columns.forEach(col => {
            html += `<td>${row[col] === null ? '' : row[col]}</td>`
          })
          html += '</tr>'
        })
        
        html += '</tbody></table>'
        resultDiv.innerHTML = html
        
      } catch (error) {
        resultDiv.innerHTML = `<p class="error">Error: ${error.message}</p>`
      }
    }
  </script>
  
</body>
</html>
